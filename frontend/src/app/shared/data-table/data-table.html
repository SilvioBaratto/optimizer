<div class="overflow-x-auto">
  <table class="w-full text-sm">
    <thead>
      <tr class="border-b border-border">
        @for (col of columns(); track col.key) {
          <th class="px-3 py-2 text-xs font-medium text-text-secondary uppercase tracking-wide whitespace-nowrap"
              [class.text-right]="col.align === 'right'"
              [class.cursor-pointer]="col.sortable"
              (click)="onSort(col)">
            <span class="inline-flex items-center gap-1">
              {{ col.label }}
              @if (col.sortable && sortKey() === col.key) {
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                  @if (sortDir() === 'asc') {
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                  } @else {
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                  }
                </svg>
              }
            </span>
          </th>
        }
      </tr>
    </thead>
    <tbody>
      @if (loading()) {
        @for (_ of [1, 2, 3, 4, 5]; track $index) {
          <tr class="border-b border-border-muted">
            @for (col of columns(); track col.key) {
              <td class="px-3 py-2">
                <div class="h-4 bg-surface-inset rounded animate-pulse"></div>
              </td>
            }
          </tr>
        }
      } @else {
        @for (row of sortedRows(); track $index) {
          <tr class="border-b border-border-muted transition-colors"
              [class.hover:bg-surface-inset]="clickable()"
              [class.cursor-pointer]="clickable()"
              (click)="onRowClick(row)">
            @for (col of columns(); track col.key) {
              <td class="px-3 py-2 text-text whitespace-nowrap"
                  [class.text-right]="col.align === 'right'">
                {{ getCellValue(row, col) }}
              </td>
            }
          </tr>
        }
        @if (sortedRows().length === 0) {
          <tr>
            <td [attr.colspan]="columns().length" class="px-3 py-8 text-center text-sm text-text-tertiary">
              No data available
            </td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>

<!-- Pagination -->
@if (totalPages() > 1) {
  <div class="flex items-center justify-between px-3 py-2 border-t border-border">
    <span class="text-xs text-text-tertiary">
      Page {{ currentPage() }} of {{ totalPages() }} ({{ total() }} rows)
    </span>
    <div class="flex gap-1">
      <button (click)="onPage(currentPage() - 1)"
              [disabled]="currentPage() <= 1"
              class="px-2 py-1 text-xs rounded border border-border text-text-secondary hover:bg-surface-inset disabled:opacity-40 disabled:cursor-not-allowed">
        Prev
      </button>
      <button (click)="onPage(currentPage() + 1)"
              [disabled]="currentPage() >= totalPages()"
              class="px-2 py-1 text-xs rounded border border-border text-text-secondary hover:bg-surface-inset disabled:opacity-40 disabled:cursor-not-allowed">
        Next
      </button>
    </div>
  </div>
}
